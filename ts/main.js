(()=>{var P=function(e){return new Promise(t=>{var r=document.createElement("script");r.src=e,r.onload=()=>{t()},document.head.appendChild(r)})},T=function(e){return new Promise(t=>{var r=document.createElement("link");r.href=e,r.type="text/css",r.rel="stylesheet",r.onload=()=>{t()},document.head.appendChild(r)})},I=function(e){for(var t=function(s){for(var i=s.childNodes,n=i.length,m=[],l,y,d,c,p=0;p<n;p++){if(l=i[p],l.nodeType!==1)continue;y=l.children[0],d=y.getAttribute("data-size").split("x"),c={src:y.getAttribute("href"),w:parseInt(d[0],10),h:parseInt(d[1],10)},l.children.length>1&&(c.title=l.children[1].innerHTML),y.children.length>0&&(c.msrc=y.children[0].getAttribute("src")),c.el=l,m.push(c)}return m},r=function s(i,n){return i&&(n(i)?i:s(i.parentNode,n))},o=function(s){s=s||window.event,s.preventDefault?s.preventDefault():s.returnValue=!1;var i=s.target||s.srcElement,n=r(i,function(b){return b.tagName&&b.tagName.toUpperCase()==="FIGURE"});if(!n)return;for(var m=n.parentNode,l=n.parentNode.childNodes,y=l.length,d=0,c,p=0;p<y;p++){if(l[p].nodeType!==1)continue;if(l[p]===n){c=d;break}d++}return c>=0&&u(c,m),!1},a=function(){var s=window.location.hash.substring(1),i={};if(s.length<5)return i;for(var n=s.split("&"),m=0;m<n.length;m++){if(!n[m])continue;var l=n[m].split("=");if(l.length<2)continue;i[l[0]]=l[1]}return i.gid&&(i.gid=parseInt(i.gid,10)),i},u=function(s,i,n,m){var l=document.querySelectorAll(".pswp")[0],y,d,c;if(c=t(i),d={galleryUID:i.getAttribute("data-pswp-uid"),getThumbBoundsFn:function(b){var L=c[b].el.getElementsByTagName("img")[0],N=window.pageYOffset||document.documentElement.scrollTop,S=L.getBoundingClientRect();return{x:S.left,y:S.top+N,w:S.width}}},m)if(d.galleryPIDs){for(var p=0;p<c.length;p++)if(c[p].pid==s){d.index=p;break}}else d.index=parseInt(s,10)-1;else d.index=parseInt(s,10);if(isNaN(d.index))return;n&&(d.showAnimationDuration=0),y=new PhotoSwipe(l,PhotoSwipeUI_Default,c,d),y.init()},h=document.querySelectorAll(e),g=0,w=h.length;g<w;g++)h[g].setAttribute("data-pswp-uid",g+1),h[g].onclick=o;var v=a();v.pid&&v.gid&&u(v.pid,h[v.gid-1],!0,!0)};function x(e){let t=document.createElement("div");t.className="gallery";let r=e[0].parentNode,o=e[0];r.insertBefore(t,o);for(let a=0;a<e.length;++a){let u=e[a].querySelector("img").width,h=e[a].querySelector("img").height;e[a].style.flexGrow=`${u*100/h}`,e[a].style.flexBasis=`${u*240/h}px`,t.appendChild(e[a])}}function M(){let e=[P("https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"),P("https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"),T("https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"),T("https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css")];return Promise.all(e)}function E(e){let t=document.querySelector(e).querySelectorAll("figure");if(t.length){let r=[t[0]];for(let o=1;o<t.length;++o)t[o].previousElementSibling===r[r.length-1]?r.push(t[o]):(x(r),r=[t[o]]);r.length>0&&x(r),M().then(()=>{let o=document.querySelector(".pswp");o.style.removeProperty("display"),I(`${e} .gallery`)})}}var f={};if(localStorage.hasOwnProperty("StackColorsCache"))try{f=JSON.parse(localStorage.getItem("StackColorsCache"))}catch(e){f={}}async function k(e,t,r){if(!e)return await Vibrant.from(r).getPalette();if(!f.hasOwnProperty(e)||f[e].hash!==t){let o=await Vibrant.from(r).getPalette();f[e]={hash:t,Vibrant:{hex:o.Vibrant.hex,rgb:o.Vibrant.rgb,bodyTextColor:o.Vibrant.bodyTextColor},DarkMuted:{hex:o.DarkMuted.hex,rgb:o.DarkMuted.rgb,bodyTextColor:o.DarkMuted.bodyTextColor}},localStorage.setItem("StackColorsCache",JSON.stringify(f))}return f[e]}var A=(e,t=500)=>{e.classList.add("transiting"),e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.height=e.offsetHeight+"px",e.offsetHeight,e.style.overflow="hidden",e.style.height="0",e.style.paddingTop="0",e.style.paddingBottom="0",e.style.marginTop="0",e.style.marginBottom="0",window.setTimeout(()=>{e.classList.remove("show"),e.style.removeProperty("height"),e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property"),e.classList.remove("transiting")},t)},q=(e,t=500)=>{e.classList.add("transiting"),e.style.removeProperty("display"),e.classList.add("show");let r=e.offsetHeight;e.style.overflow="hidden",e.style.height="0",e.style.paddingTop="0",e.style.paddingBottom="0",e.style.marginTop="0",e.style.marginBottom="0",e.offsetHeight,e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.height=r+"px",e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),window.setTimeout(()=>{e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property"),e.classList.remove("transiting")},t)},V=(e,t=500)=>window.getComputedStyle(e).display==="none"?q(e,t):A(e,t);function C(){let e=document.getElementById("toggle-menu");e&&e.addEventListener("click",()=>{if(document.getElementById("main-menu").classList.contains("transiting"))return;document.body.classList.toggle("show-menu"),V(document.getElementById("main-menu"),300),e.classList.toggle("is-active")})}var D={init:()=>{C(),document.querySelector(".article-content")&&E(".article-content"),document.querySelectorAll(".color-tag").forEach(async t=>{let r=t.getAttribute("data-image"),o=t.getAttribute("data-key"),a=t.getAttribute("data-hash"),u=await k(o,a,r);t.style.color=u.Vibrant.bodyTextColor,t.style.background=u.Vibrant.hex});let e=document.querySelector(".article-list--tile");if(e){let t=new IntersectionObserver(async(r,o)=>{r.forEach(a=>{if(!a.isIntersecting)return;o.unobserve(a.target);let u=a.target.querySelectorAll("article.has-image");u.forEach(async h=>{let g=h.querySelector("img"),w=g.src,v=g.getAttribute("data-key"),s=g.getAttribute("data-hash"),i=h.querySelector(".article-details"),n=await k(v,s,w);i.style.background=`
                        linear-gradient(0deg, 
                            rgba(${n.DarkMuted.rgb[0]}, ${n.DarkMuted.rgb[1]}, ${n.DarkMuted.rgb[2]}, 0.5) 0%, 
                            rgba(${n.Vibrant.rgb[0]}, ${n.Vibrant.rgb[1]}, ${n.Vibrant.rgb[2]}, 0.75) 100%)`})})});t.observe(e)}}};window.addEventListener("load",()=>{setTimeout(function(){D.init()},0)});window.Stack=D;})();
/*!
*   Hugo Theme Stack
*
*   @author: Jimmy Cai
*   @website: https://jimmycai.com
*   @link: https://github.com/CaiJimmy/hugo-theme-stack
*/
